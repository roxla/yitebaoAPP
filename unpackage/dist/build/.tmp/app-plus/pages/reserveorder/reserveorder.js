(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/reserveorder/reserveorder"],{"205f":function(e,t,r){"use strict";r.r(t);var o=r("4206"),s=r.n(o);for(var n in o)"default"!==n&&function(e){r.d(t,e,function(){return o[e]})}(n);t["default"]=s.a},4206:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){return Promise.all([r.e("common/vendor"),r.e("components/w-picker/w-picker")]).then(r.bind(null,"9894"))},s=function(){return r.e("node-modules/@dcloudio/uni-ui/lib/uni-icon/uni-icon").then(r.bind(null,"6fba"))},n={components:{wPicker:o,uniIcon:s},data:function(){return{height:0,fullAddress:"",userName:"",tel:"",addressList:!1,orderTime:"请选择预约时间",orderShop:"请选择预约店铺",selectList:[],shopAddress:"",shopTel:"",shopNo:"",count:"",remark:"",time:""}},onNavigationBarButtonTap:function(){e.reLaunch({url:"../laundry/laundry"})},onLoad:function(t){this.height=e.getSystemInfoSync().windowHeight-36,this.$showLoading(),t.userName&&t.address&&t.tel?(this.fullAddress=t.address+" "+t.addressDetails,this.userName=t.userName,this.tel=t.tel,this.$hideLoading()):this.getDefAddress(),this.getData(),this.getShopList()},methods:{getDefAddress:function(){var t=this;e.request({url:this.apiServer+"userServer/cunUserServer/getDefaultAddress",method:"POST",data:{OpenId:e.getStorageSync("openid")},header:{"content-Type":"application/x-www-form-urlencoded"},success:function(r){if(200===r.data.status)if(r.data.data){var o=r.data.data;console.log(o," at pages\\reserveorder\\reserveorder.vue:142"),t.fullAddress=o.address+" "+o.addressDetails,t.userName=o.userName,t.tel=o.tel,t.addressList=!1}else t.addressList=!0;else e.showToast({title:r.data.msg,duration:2e3,icon:"none"})},fail:function(){t.reconnect("../reserveorder/reserveorder",1)},complete:function(){t.$hideLoading()}})},getData:function(){var t=this;e.request({url:this.apiServer+"thingServer/openThingServer/getTeyClothes",method:"POST",data:{teyKey:e.getStorageSync("shopKey")},header:{"content-Type":"application/x-www-form-urlencoded"},success:function(r){if(200===r.data.status){for(var o=r.data.data,s=0,n=0;n<o.length;n++)s+=parseInt(o[n].number);t.count=s}else e.showToast({title:r.data.msg,duration:2e3,icon:"none"})},fail:function(){e.showToast({title:"网络请求失败",duration:2e3,icon:"none"})}})},getShopList:function(){var t=this;e.request({url:this.apiServer+"shopServer/openShopServer/getShopList",method:"POST",header:{"content-Type":"application/x-www-form-urlencoded"},success:function(r){if(200===r.data.status){for(var o=r.data.data,s=[],n=0;n<o.length;n++)s.push({label:o[n].shopName,value:o[n].shopNo});t.selectList=s}else e.showToast({title:r.data.msg,duration:2e3,icon:"none"})},fail:function(){e.showToast({title:"网络请求失败",duration:2e3,icon:"none"})}})},getShopData:function(t){var r=this;e.request({url:this.apiServer+"shopServer/openShopServer/getShopData",method:"POST",data:{shopNo:t},header:{"content-Type":"application/x-www-form-urlencoded"},success:function(t){200===t.data.status?(r.shopAddress=t.data.data.shopAdd,r.shopTel=t.data.data.contectTel):e.showToast({title:t.data.msg,duration:2e3,icon:"none"})},fail:function(){e.showToast({title:"网络请求失败",duration:2e3,icon:"none"})}})},changeAddress:function(){e.reLaunch({url:"../address/address?type=2"})},toggleTab:function(e){this.mode=e,this.$refs[e].show()},onConfirm:function(e){switch(this.mode){case"limit":this.orderTime=e.checkArr[0].value+" "+e.checkArr[1].value+":"+e.checkArr[2].value;break;case"selector":this.orderShop=e.result,this.shopNo=e.checkArr.value,this.getShopData(e.checkArr.value);break}},orderSubmit:function(){this.addressList?e.showToast({title:"请选择地址",duration:2e3,icon:"none"}):"请选择预约店铺"!=this.orderShop?e.request({url:this.apiServer+"orderServer/cunOrderServer/createReservation",method:"POST",data:{OpenId:e.getStorageSync("openid"),userTel:this.tel,userAddress:this.fullAddress,userName:this.userName,teyClothesKey:e.getStorageSync("shopKey"),shopNo:this.shopNo,number:this.count,arriveTime:this.orderTime,remark:this.remark},header:{"content-Type":"application/x-www-form-urlencoded"},success:function(t){console.log(t," at pages\\reserveorder\\reserveorder.vue:307"),200===t.data.status?(e.removeStorageSync("shopKey"),e.setStorageSync("orderNo",t.data.data),e.reLaunch({url:"../ordersuccess/ordersuccess"})):e.showToast({title:t.data.msg,duration:2e3,icon:"none"})},fail:function(){e.showToast({title:"网络请求失败",duration:2e3,icon:"none"})}}):e.showToast({title:"请选择预约店铺",duration:2e3,icon:"none"})}}};t.default=n}).call(this,r("6e42")["default"])},"46e3":function(e,t,r){"use strict";var o=r("72f8"),s=r.n(o);s.a},"5ff0":function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},s=[];r.d(t,"a",function(){return o}),r.d(t,"b",function(){return s})},"72f8":function(e,t,r){},ffe0:function(e,t,r){"use strict";r.r(t);var o=r("5ff0"),s=r("205f");for(var n in s)"default"!==n&&function(e){r.d(t,e,function(){return s[e]})}(n);r("46e3");var a=r("2877"),i=Object(a["a"])(s["default"],o["a"],o["b"],!1,null,"3d247088",null);t["default"]=i.exports}},[["63a7","common/runtime","common/vendor"]]]);